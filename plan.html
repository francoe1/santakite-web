<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <title>Kitesurf Santa Ana – Playa 52</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Fuente más profesional -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Leaflet CSS (sin integrity para evitar quilombos de SRI) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <style>
        :root {
            --bg: #020617;
            --bg-alt: #050816;
            --accent: #00c2ff;
            --accent-soft: rgba(0, 194, 255, 0.1);
            --text: #f9fafb;
            --muted: #9ca3af;
            --danger: #ef4444;
            --warn: #f59e0b;
            --ok: #22c55e;
            --card-bg: #020617;
            --card-elevated: #02081c;
            --border-soft: rgba(148, 163, 184, 0.25);
            --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.85);
            --radius-lg: 1.25rem;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html,
        body {
            scroll-behavior: smooth;
        }

        body {
            font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background:
                radial-gradient(circle at 0 0, #1f2937 0, transparent 55%),
                radial-gradient(circle at 100% 0, #0f172a 0, transparent 55%),
                radial-gradient(circle at 50% 100%, #111827 0, transparent 55%),
                #020617;
            color: var(--text);
            line-height: 1.6;
        }

        a {
            color: inherit;
            text-decoration: none;
        }

        /* Top bar simple */
        .topbar {
            position: sticky;
            top: 0;
            z-index: 50;
            backdrop-filter: blur(14px);
            background: linear-gradient(to right, rgba(15, 23, 42, 0.92), rgba(2, 6, 23, 0.92));
            border-bottom: 1px solid rgba(31, 41, 55, 0.8);
        }

        .topbar-inner {
            max-width: 1180px;
            margin: 0 auto;
            padding: 0.7rem 1.25rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1.5rem;
        }

        .brand-mark {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .brand-logo {
            width: 26px;
            height: 26px;
            border-radius: 999px;
            background: radial-gradient(circle at 30% 0, #38bdf8, #0ea5e9 40%, #0f172a 85%);
            box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.35);
            position: relative;
            overflow: hidden;
        }

        .brand-logo::after {
            content: "";
            position: absolute;
            inset: 25% 35%;
            border-radius: 999px 999px 20px 20px;
            background: rgba(15, 23, 42, 0.9);
        }

        .topbar-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            font-size: 0.84rem;
            color: var(--muted);
        }

        .topbar-nav button {
            background: transparent;
            border: none;
            color: inherit;
            cursor: pointer;
            padding: 0.3rem 0.75rem;
            border-radius: 999px;
            transition: background 0.15s, color 0.15s;
        }

        .topbar-nav button:hover {
            background: rgba(15, 23, 42, 0.9);
            color: var(--accent);
        }

        .page {
            max-width: 1180px;
            margin: 0 auto;
            padding: 1.5rem 1.25rem 3rem;
        }

        header {
            min-height: 88vh;
            display: grid;
            grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
            gap: 2.25rem;
            align-items: center;
            padding-top: 1.5rem;
        }

        @media (max-width: 900px) {
            header {
                grid-template-columns: 1fr;
                min-height: auto;
            }
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.35rem 0.85rem;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid var(--border-soft);
            font-size: 0.78rem;
            text-transform: uppercase;
            letter-spacing: 0.14em;
            color: var(--muted);
            margin-bottom: 1.25rem;
        }

        .badge-dot {
            width: 9px;
            height: 9px;
            border-radius: 999px;
            background: #22c55e;
            box-shadow: 0 0 0 6px rgba(34, 197, 94, 0.2);
        }

        h1 {
            font-size: clamp(2.5rem, 3.9vw, 3.8rem);
            line-height: 1.04;
            margin-bottom: 0.75rem;
        }

        h1 span {
            color: var(--accent);
        }

        .subtitle {
            font-size: 1rem;
            color: var(--muted);
            max-width: 34rem;
            margin-bottom: 1.75rem;
        }

        .hero-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.9rem;
            margin-bottom: 1.45rem;
        }

        .btn {
            border-radius: 999px;
            padding: 0.75rem 1.5rem;
            border: 1px solid transparent;
            font-weight: 500;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.15s ease-out;
            display: inline-flex;
            align-items: center;
            gap: 0.45rem;
            background: none;
            color: inherit;
            white-space: nowrap;
        }

        .btn-primary {
            background: linear-gradient(135deg, #00c2ff, #38bdf8);
            color: #020617;
            box-shadow: 0 18px 40px rgba(56, 189, 248, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 22px 55px rgba(56, 189, 248, 0.5);
        }

        .btn-outline {
            border-color: var(--border-soft);
            background: rgba(15, 23, 42, 0.85);
            color: var(--muted);
        }

        .btn-outline:hover {
            border-color: var(--accent);
            color: var(--accent);
            background: rgba(15, 23, 42, 0.98);
        }

        .hero-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.65rem;
            font-size: 0.82rem;
            color: var(--muted);
        }

        .hero-meta span {
            padding: 0.35rem 0.7rem;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.92);
            border: 1px solid rgba(31, 41, 55, 0.8);
        }

        .hero-visual {
            position: relative;
            min-height: 290px;
            border-radius: 1.5rem;
            overflow: hidden;
            background:
                radial-gradient(circle at 20% 0%, #22d3ee 0, transparent 60%),
                radial-gradient(circle at 80% 120%, #38bdf8 0, transparent 55%),
                #020617;
            border: 1px solid rgba(148, 163, 184, 0.25);
            box-shadow: 0 30px 80px rgba(15, 23, 42, 0.95);
            display: flex;
            flex-direction: column;
        }

        .hero-visual-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 1rem;
            background: linear-gradient(to right,
                    rgba(15, 23, 42, 0.96),
                    rgba(15, 23, 42, 0.75));
            border-bottom: 1px solid rgba(148, 163, 184, 0.25);
            font-size: 0.78rem;
        }

        .hero-visual-tag {
            padding: 0.2rem 0.6rem;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.4);
            color: var(--muted);
        }

        .hero-visual-body {
            flex: 1;
            display: grid;
            grid-template-rows: minmax(0, 2fr) minmax(0, 1.2fr);
        }

        #three-container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .mini-wind {
            padding: 0.9rem 1rem;
            background: rgba(15, 23, 42, 0.95);
            border-top: 1px solid rgba(148, 163, 184, 0.25);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: var(--muted);
            backdrop-filter: blur(14px);
        }

        .mini-wind-main {
            display: flex;
            flex-direction: column;
            gap: 0.1rem;
        }

        .mini-wind-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: #6b7280;
        }

        .mini-wind-value {
            font-weight: 500;
            color: var(--text);
        }

        .mini-wind-chip {
            padding: 0.25rem 0.6rem;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            font-size: 0.7rem;
            white-space: nowrap;
        }

        .section {
            padding: 3.6rem 0;
            border-top: 1px solid rgba(31, 41, 55, 0.85);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 1.5rem;
            margin-bottom: 1.8rem;
        }

        .section-title {
            font-size: 1.55rem;
            font-weight: 600;
        }

        .section-kicker {
            font-size: 0.86rem;
            color: var(--muted);
            max-width: 480px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: minmax(0, 1.05fr) minmax(0, 1fr);
            gap: 2rem;
        }

        @media (max-width: 900px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: radial-gradient(circle at 0 0, rgba(15, 23, 42, 0.7), transparent 60%),
                radial-gradient(circle at 100% 100%, rgba(17, 24, 39, 0.7), transparent 60%),
                var(--card-bg);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-soft);
            padding: 1.3rem;
            box-shadow: var(--shadow-soft);
        }

        .pill-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.8rem;
        }

        .pill {
            padding: 0.25rem 0.6rem;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.25);
            font-size: 0.8rem;
            color: var(--muted);
        }

        #spot-map {
            width: 100%;
            height: 360px;
            border-radius: 1rem;
            overflow: hidden;
            border: 1px solid rgba(148, 163, 184, 0.4);
            box-shadow: var(--shadow-soft);
        }

        .zones-legend {
            margin-top: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            font-size: 0.8rem;
        }

        .legend-item {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.25rem 0.6rem;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.3);
            color: var(--muted);
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 999px;
        }

        .legend-launch {
            background: rgba(34, 197, 94, 0.9);
        }

        .legend-swim {
            background: rgba(239, 68, 68, 0.9);
        }

        .windy-wrapper {
            border-radius: 1rem;
            overflow: hidden;
            border: 1px solid rgba(148, 163, 184, 0.4);
            box-shadow: var(--shadow-soft);
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1rem;
        }

        .forecast-card {
            border-radius: 1rem;
            padding: 0.9rem 0.85rem;
            background: radial-gradient(circle at 0 0, rgba(15, 23, 42, 0.9), transparent 60%),
                rgba(15, 23, 42, 0.96);
            border: 1px solid rgba(31, 41, 55, 0.9);
            display: flex;
            flex-direction: column;
            gap: 0.35rem;
            font-size: 0.85rem;
        }

        .forecast-date {
            font-weight: 500;
        }

        .forecast-badge {
            width: fit-content;
            margin-top: 0.25rem;
            padding: 0.2rem 0.55rem;
            border-radius: 999px;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.12em;
        }

        .badge-ok {
            background: rgba(34, 197, 94, 0.12);
            border: 1px solid rgba(34, 197, 94, 0.5);
            color: var(--ok);
        }

        .badge-warn {
            background: rgba(245, 158, 11, 0.12);
            border: 1px solid rgba(245, 158, 11, 0.5);
            color: var(--warn);
        }

        .badge-bad {
            background: rgba(239, 68, 68, 0.12);
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: var(--danger);
        }

        .rules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1rem;
        }

        .rule-title {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .rule-text {
            font-size: 0.9rem;
            color: var(--muted);
        }

        footer {
            padding: 2.5rem 0 1.5rem;
            border-top: 1px solid rgba(31, 41, 55, 0.9);
            font-size: 0.78rem;
            color: var(--muted);
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 0.75rem;
        }

        footer a {
            color: var(--accent);
        }

        .link-inline {
            text-decoration: underline;
            text-decoration-color: rgba(56, 189, 248, 0.7);
            text-decoration-thickness: 1px;
        }

        .anchor-spacer {
            scroll-margin-top: 80px;
        }

        .status-label {
            font-size: 0.8rem;
            color: var(--muted);
        }

        .status-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 999px;
            margin-right: 0.35rem;
        }

        .status-dot-live {
            background: #22c55e;
            box-shadow: 0 0 0 6px rgba(34, 197, 94, 0.2);
        }

        .status-dot-error {
            background: #ef4444;
            box-shadow: 0 0 0 6px rgba(239, 68, 68, 0.2);
        }

        .status-dot-loading {
            background: #eab308;
            box-shadow: 0 0 0 6px rgba(234, 179, 8, 0.2);
        }

        .wind-card {
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem 1.2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .wind-header {
            display: flex;
            flex-direction: column;
        }

        .wind-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .wind-subtitle {
            font-size: 0.75rem;
            color: var(--muted);
        }

        .wind-body {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .wind-arrow-container {
            width: 80px;
            height: 80px;
            background: var(--bg);
            border-radius: 50%;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .wind-arrow {
            width: 0;
            height: 0;
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-bottom: 28px solid var(--accent);
            transform: rotate(0deg);
            transition: transform 0.4s ease;
        }

        .wind-info {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }

        .wind-row {
            display: flex;
            justify-content: space-between;
            font-size: 1rem;
        }

        .wind-label {
            color: var(--muted);
        }

        .wind-value {
            font-weight: 600;
        }

        .wind-rating {
            margin-top: 0.5rem;
            padding: 0.4rem 0.7rem;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
            background: var(--border);
            color: var(--fg);
        }

        .wind-rating.good {
            background: rgba(0, 200, 0, 0.15);
            color: #1bd41b;
        }

        .wind-rating.ok {
            background: rgba(255, 200, 0, 0.15);
            color: #e2b400;
        }

        .wind-rating.bad {
            background: rgba(255, 0, 0, 0.15);
            color: #ff4b4b;
        }
    </style>
</head>

<body>
    <!-- Barra superior -->
    <div class="topbar">
        <div class="topbar-inner">
            <div class="brand-mark">
                <div class="brand-logo"></div>
                <div>
                    <div style="font-size:0.9rem;">Kitesurf Santa Ana</div>
                    <div style="font-size:0.7rem; color:var(--muted);">Playa 52 · Lago Salto Grande</div>
                </div>
            </div>
            <nav class="topbar-nav">
                <button onclick="scrollToId('spot')">El spot</button>
                <button onclick="scrollToId('map')">Mapa</button>
                <button onclick="scrollToId('forecast')">Condiciones</button>
                <button onclick="scrollToId('safety')">Seguridad</button>
                <button onclick="scrollToId('tech')">Info técnica</button>
            </nav>
        </div>
    </div>

    <div class="page">
        <!-- HERO -->
        <header id="top">
            <div>
                <div class="badge">
                    <div class="badge-dot"></div>
                    Spot no oficial · Proyecto de ordenamiento local
                </div>

                <h1>
                    Kitesurf <span>Santa Ana</span> – Playa 52
                </h1>

                <p class="subtitle">
                    Página informativa para ordenar el uso de Playa 52 como spot de kitesurf.
                    Viento, mapa, zonas y normas de seguridad, con datos basados en modelo GFS.
                </p>

                <div class="hero-actions">
                    <button class="btn btn-primary" onclick="scrollToId('forecast')">
                        Condiciones para navegar HOY
                    </button>
                    <button class="btn btn-outline" onclick="scrollToId('safety')">
                        Normas de seguridad
                    </button>
                </div>

                <div class="hero-meta">
                    <span>Vientos recomendados: Sur · Sudeste · Este</span>
                    <span>Agua: lago · chop, poca corriente</span>
                    <span>Ubicación: Santa Ana, Entre Ríos (cerca de Chajarí)</span>
                </div>
            </div>

            <div class="hero-visual wind-card">
                <div class="wind-header">
                    <span class="wind-title">Viento Actual · GFS</span>
                    <span class="wind-subtitle">Actualizado en tiempo real</span>
                </div>

                <div class="wind-body">
                    <div class="wind-arrow-container">
                        <div class="wind-arrow" id="windArrow"></div>
                    </div>

                    <div class="wind-info">
                        <div class="wind-row">
                            <span class="wind-label">Dirección:</span>
                            <span class="wind-value" id="windDirText">–°</span>
                        </div>
                        <div class="wind-row">
                            <span class="wind-label">Velocidad:</span>
                            <span class="wind-value" id="windSpeedText">– nudos</span>
                        </div>

                        <div class="wind-rating" id="windRating">Cargando...</div>
                    </div>
                </div>
            </div>

        </header>

        <!-- EL SPOT -->
        <section id="spot" class="section anchor-spacer">
            <div class="section-header">
                <h2 class="section-title">El spot · Playa 52</h2>
                <p class="section-kicker">
                    Playa 52 está sobre la costa del Lago Salto Grande, muy cerca de Santa Ana y Chajarí.
                    Es un spot de lago, con oleaje corto, ideal para navegación freeride y práctica de maniobras.
                </p>
            </div>

            <div class="grid-2">
                <div class="card">
                    <h3 style="margin-bottom: 0.5rem;">Ficha rápida del spot</h3>
                    <p style="font-size: 0.9rem; color: var(--muted); margin-bottom: 0.75rem;">
                        Navegación en lago con fondo relativamente uniforme y una zona amplia de arena.
                        Ideal para riders intermedios y avanzados; se puede destinar un área específica
                        para principiantes y escuelas.
                    </p>
                    <div class="pill-row">
                        <span class="pill">Vientos útiles: Sur · Sudeste · Este</span>
                        <span class="pill">Agua: lago · choppeado</span>
                        <span class="pill">Nivel ideal: intermedio/avanzado</span>
                        <span class="pill">Posible zona de principiantes delimitada</span>
                    </div>
                </div>

                <div class="card">
                    <h3 style="margin-bottom: 0.5rem;">Objetivo de esta web</h3>
                    <p class="rule-text">
                        • Dar información clara para evitar que se navegue encima de bañistas.<br />
                        • Proponer zonas de armado, despegue y navegación ordenadas.<br />
                        • Ofrecer un criterio básico de “apto / dudoso / no apto” usando modelo GFS.<br />
                        • Facilitar el diálogo con municipio, guardavidas y escuelas si las hubiera.
                    </p>
                </div>
            </div>
        </section>

        <!-- MAPA & WINDY -->
        <section id="map" class="section anchor-spacer">
            <div class="section-header">
                <h2 class="section-title">Mapa del spot &amp; zonas sugeridas</h2>
                <p class="section-kicker">
                    Referencia visual de la ubicación de Playa 52, con un ejemplo de sector de kites y
                    zona donde no deberían ingresar bañistas cuando hay cometas en el aire.
                </p>
            </div>

            <div class="grid-2">
                <div>
                    <div id="spot-map"></div>
                    <div class="zones-legend">
                        <div class="legend-item">
                            <span class="legend-color legend-launch"></span>
                            Zona de kites (despegue / aterrizaje / navegación cercana
                        </div>
                        <div class="legend-item">
                            <span class="legend-color legend-swim"></span>
                            Prohibido bañistas cuando hay cometas
                        </div>
                    </div>
                </div>

                <div>
                    <div class="card" style="margin-bottom: 1rem;">
                        <h3 style="margin-bottom: 0.5rem;">Viento en tiempo real (GFS)</h3>
                        <p class="rule-text" style="margin-bottom: 0.75rem;">
                            Este visor de Windy está configurado para mostrar viento (modelo
                            <strong>GFS</strong>) sobre Playa 52. Es una referencia general: siempre
                            combiná pronóstico, observación local y criterio personal.
                        </p>
                        <div class="windy-wrapper">
                            <!-- Windy embed con product=gfs -->
                            <iframe width="100%" height="320"
                                src="https://embed.windy.com/embed2.html?lat=-30.9085&lon=-57.915&zoom=12&level=surface&overlay=wind&product=gfs"
                                frameborder="0">
                            </iframe>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- FORECAST -->
        <section id="forecast" class="section anchor-spacer">
            <div class="section-header">
                <h2 class="section-title">¿Es apto para navegar? (Próximos 7 días)</h2>
                <p class="section-kicker">
                    Resumen orientado a kitesurf usando datos reales GFS
                </p>
            </div>

            <div class="card" style="margin-bottom: 1rem;">
                <div
                    style="display:flex; justify-content:space-between; align-items:center; gap:1rem; margin-bottom:0.75rem;">
                    <p class="rule-text">
                        Criterio base: viento medio entre <strong>12–30 nudos</strong>, dirección
                        <strong>Sur / Sudeste / Este</strong>, sin tormentas eléctricas.
                    </p>
                    <div class="status-label" id="forecastStatus">
                        <span class="status-dot status-dot-loading"></span>
                        Cargando datos de viento (GFS)…
                    </div>
                </div>

                <div id="forecast-grid" class="forecast-grid"></div>
            </div>
        </section>

        <!-- NORMAS SEGURIDAD -->
        <section id="safety" class="section anchor-spacer">
            <div class="section-header">
                <h2 class="section-title">Normas de seguridad</h2>
                <p class="section-kicker">
                    Reglas básicas para cuidar a quien navega y a quien viene simplemente a pasar
                    el día a la playa.
                </p>
            </div>

            <div class="rules-grid">
                <div class="card">
                    <div class="rule-title">Para público general</div>
                    <p class="rule-text">
                        • No caminar, correr ni jugar en la zona marcada como área de líneas.<br />
                        • Evitar sombrillas, reposeras o carpas en el corredor de entrada/salida de kites.<br />
                        • Ante una cometa descontrolada, alejarse de las líneas; nunca intentar atraparla.
                    </p>
                </div>

                <div class="card">
                    <div class="rule-title">Para kitesurfistas</div>
                    <p class="rule-text">
                        • Armar y desarmar el equipo sólo en la zona destinada a kites.<br />
                        • Mantener siempre distancia de bañistas, embarcaciones y otros kites.<br />
                        • Usar casco y chaleco de flotación, especialmente con viento fuerte o racheado.<br />
                        • Saber activar el quick-release y practicar auto-rescate regularmente.
                    </p>
                </div>

                <div class="card">
                    <div class="rule-title">Condiciones críticas</div>
                    <p class="rule-text">
                        • No navegar con tormentas eléctricas o avisos de tormenta severa.<br />
                        • Evitar navegar solo; avisar siempre a alguien en tierra.<br />
                        • Si no podés volver, soltar primero la tabla, luego la barra si es necesario,
                        y hacer señas claras pidiendo ayuda.
                    </p>
                </div>
            </div>
        </section>

        <!-- SECCIÓN TÉCNICA -->
        <section id="tech" class="section anchor-spacer">
            <div class="section-header">
                <h2 class="section-title">Detalles técnicos del spot</h2>
                <p class="section-kicker">
                    Información orientativa para que puedas elegir tamaño de cometa, tabla y traje con
                    un poco más de contexto.
                </p>
            </div>

            <div class="grid-2">
                <div class="card">
                    <h3 style="margin-bottom:0.5rem;">Rango de viento &amp; quiver típico</h3>
                    <p class="rule-text">
                        • Rango habitual de viento útil: <strong>12–25 nudos</strong>.<br />
                        • Kites frecuentes según peso del rider (twin-tip):<br />
                        &nbsp;&nbsp;– &lt; 65 kg: 7m – 10m<br />
                        &nbsp;&nbsp;– 65–80 kg: 8m – 12m<br />
                        &nbsp;&nbsp;– 80–95 kg: 9m – 13m<br />
                        • El foil puede ser una opción con viento más bajo, sólo para riders con experiencia.
                    </p>

                    <h3 style="margin:1rem 0 0.35rem;">Equipo recomendado</h3>
                    <p class="rule-text">
                        Según la época del año y la temperatura del agua, un traje 3/2 o 4/3 suele alcanzar.
                        Siempre se recomienda:
                    </p>
                    <p class="rule-text">
                        • Casco homologado<br />
                        • Chaleco de impacto / flotación<br />
                        • Leash de tabla según condiciones de chop y viento cruzado<br />
                        • Botiquín básico y comunicación (celular en funda estanca, por ejemplo)
                    </p>
                </div>

                <div class="card">
                    <h3 style="margin-bottom:0.5rem;">Visualizador 3D del viento</h3>
                    <p class="rule-text" style="margin-bottom:0.75rem;">
                        La escena simplificada muestra un plano (lago), flechas de viento y un bloque
                        que representa al rider/cometa. Podés usarla para explicar por qué un Sur,
                        Sudeste o Este son más cómodos y qué implica cada ángulo.
                    </p>
                    <div
                        style="height:260px; border-radius:0.75rem; overflow:hidden; border:1px solid var(--border-soft);">
                        <canvas id="three-canvas-overlay" style="width:100%;height:100%;"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <footer>
            <span>
                © <span id="year"></span> Proyecto Kitesurf Santa Ana – Playa 52.
                Información orientativa, sin carácter oficial. Navegar siempre con criterio y responsabilidad.
            </span>
            <span>
                Más info sobre la localidad en
                <a class="link-inline" href="https://santaana.gob.ar" target="_blank" rel="noreferrer">
                    santaana.gob.ar
                </a>
            </span>
        </footer>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Three.js (modo clásico, el warning es sólo deprecación futura) -->
    <script src="https://unpkg.com/three@0.159.0/build/three.min.js"></script>

    <script>
        // ========================
        // Scroll suave
        // ========================
        function scrollToId(id) {
            const el = document.getElementById(id);
            if (!el) return;
            el.scrollIntoView({ behavior: "smooth" });
        }

        document.addEventListener("DOMContentLoaded", () => {
            // FOOTER YEAR
            document.getElementById("year").textContent = new Date().getFullYear();

            // ========================
            // MAPA LEAFLET
            // ========================
            const spotLat = -30.9085;
            const spotLon = -57.915;

            const map = L.map("spot-map").setView([spotLat - 0.005, spotLon - 0.003], 14.5);

            L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
                maxZoom: 17,
                minZoom: 10
            }).addTo(map);

            L.marker([spotLat, spotLon + 0.001])
                .addTo(map)
                .bindPopup("Playa 52 - Spot de Kitesurf");

            L.marker([spotLat - 0.004, spotLon + 0.001])
                .addTo(map)
                .bindPopup("Construcción cercana: tener precaución con niveles bajos de agua");

            // Ejemplo de zona de kites
            const launchZoneCoords = [
                [spotLat + 0.0005, spotLon],
                [spotLat + 0.0005, spotLon + 0.002],
                [spotLat - 0.0002, spotLon + 0.002],
                [spotLat - 0.0002, spotLon]
            ];

            // Zona amplia donde se recomienda no colocar bañistas
            const swimZoneCoords = [
                [spotLat - 0.0002, spotLon],
                [spotLat - 0.0002, spotLon + 0.002],
                [spotLat - 0.0051, spotLon + 0.002],
                [spotLat - 0.0051, spotLon - 0.009],
                [spotLat - 0.003, spotLon - 0.008],
                [spotLat - 0.001, spotLon - 0.005]
            ];

            L.polygon(launchZoneCoords, {
                color: "#22c55e",
                fillColor: "#22c55e",
                fillOpacity: 0.35,
                weight: 2
            })
                .addTo(map)
                .bindPopup("Zona de kites (despegue / aterrizaje / navegación cercana)");

            L.polygon(swimZoneCoords, {
                color: "#ef4444",
                fillColor: "#ef4444",
                fillOpacity: 0.25,
                weight: 2
            })
                .addTo(map)
                .bindPopup("Prohibido bañistas cuando hay cometas");

            // ========================
            // FORECAST REAL (sin datos falsos)
            // ========================
            const forecastGrid = document.getElementById("forecast-grid");
            const forecastStatus = document.getElementById("forecastStatus");

            function degToCompass(deg) {
                const dirs = ["N", "NE", "E", "SE", "S", "SO", "O", "NO"];
                return dirs[Math.round(deg / 45) % 8];
            }

            function classifyDay(day) {
                const dir = day.mainDirDeg;
                const speed = day.avgWindKts;
                const hasStorm = day.hasStorm;

                const isGoodDir =
                    (dir >= 60 && dir <= 120) ||    // E ±30
                    (dir >= 105 && dir <= 165) ||   // SE ±30
                    (dir >= 150 && dir <= 210);     // S ±30

                const isGoodSpeed = speed >= 12 && speed <= 30;

                if (hasStorm) {
                    return { label: "No apto", className: "badge-bad" };
                }

                if (isGoodDir && isGoodSpeed) {
                    return { label: "Óptimo", className: "badge-ok" };
                }

                if (speed < 10 || speed > 32) {
                    return { label: "No apto", className: "badge-bad" };
                }

                return { label: "Dudoso", className: "badge-warn" };
            }

            function setStatusLoading() {
                forecastStatus.innerHTML =
                    '<span class="status-dot status-dot-loading"></span> Cargando datos de viento (GFS)…';
            }

            function setStatusError(msg) {
                forecastStatus.innerHTML =
                    '<span class="status-dot status-dot-error"></span> Error al cargar pronóstico: ' +
                    (msg || "revisar backend /api/forecast");
            }

            function setStatusOk() {
                forecastStatus.innerHTML =
                    '<span class="status-dot status-dot-live"></span> Datos cargados desde backend GFS';
            }

            async function loadForecast() {
                setStatusLoading();
                forecastGrid.innerHTML = "";

                try {
                    const url =
                        "https://api.open-meteo.com/v1/gfs?" +
                        "latitude=-30.90&longitude=-57.93&" +
                        "hourly=winddirection_10m,windspeed_10m,windgusts_10m";

                    const response = await fetch(url);
                    if (!response.ok) throw new Error("HTTP " + response.status);

                    const data = await response.json();

                    // Convertimos a formato de tu UI
                    const days = [];
                    const { time, windspeed_10m, winddirection_10m } = data.hourly;

                    // Agrupar por día (promedios)
                    const map = {};

                    for (let i = 0; i < time.length; i++) {
                        const date = time[i].split("T")[0];
                        if (!map[date]) {
                            map[date] = { speeds: [], dirs: [] };
                        }
                        map[date].speeds.push(windspeed_10m[i]);
                        map[date].dirs.push(winddirection_10m[i]);
                    }

                    Object.keys(map).forEach(date => {
                        const speeds = map[date].speeds;
                        const dirs = map[date].dirs;

                        const avgWind = speeds.reduce((a, b) => a + b, 0) / speeds.length;
                        const avgDir = dirs.reduce((a, b) => a + b, 0) / dirs.length;

                        days.push({
                            date,
                            avgWindKts: Math.round(avgWind / 1.852), // GFS devuelve m/s
                            mainDirDeg: Math.round(avgDir),
                            hasStorm: false // GFS no provee tormenta eléctrica sin otro endpoint
                        });
                    });

                    renderForecast(days);
                    updateMiniWind(days[0]);
                    setStatusOk();

                } catch (err) {
                    console.error("Error loading forecast:", err);
                    setStatusError(err.message);
                    forecastGrid.innerHTML =
                        '<div style="font-size:0.85rem; color:var(--muted);">No se pudo cargar el pronóstico GFS.</div>';
                }
            }

            function renderForecast(days) {
                forecastGrid.innerHTML = "";

                days.forEach((day) => {
                    const { label, className } = classifyDay(day);
                    const dirCompass = degToCompass(day.mainDirDeg);

                    const card = document.createElement("div");
                    card.className = "forecast-card";

                    const date = new Date(day.date);
                    const dateStr = isNaN(date.getTime())
                        ? day.date
                        : date.toLocaleDateString("es-AR", {
                            weekday: "short",
                            day: "numeric",
                            month: "short"
                        });

                    card.innerHTML = `
            <div class="forecast-date">${dateStr}</div>
            <div style="font-size:0.8rem; color:var(--muted);">
              Viento medio:
              <strong>${day.avgWindKts.toFixed(0)}</strong> nudos
              ·
              Dir:
              <strong>${dirCompass}</strong>
              (${day.mainDirDeg}&deg;)
            </div>
            <div class="forecast-badge ${className}">${label}</div>
            <div style="font-size:0.75rem; color:var(--muted); margin-top:0.3rem;">
              Tormentas: ${day.hasStorm ? "Sí" : "No"}
            </div>
          `;

                    forecastGrid.appendChild(card);
                });
            }

            function updateMiniWind(day) {
                /*
                const dirCompass = degToCompass(day.mainDirDeg);
                document.getElementById("miniWindDir").textContent = dirCompass;
                document.getElementById("miniWindSpeed").textContent = day.avgWindKts.toFixed(0);

                const classification = classifyDay(day);
                const miniTag = document.getElementById("miniWindTag");
                miniTag.textContent = `Hoy: ${classification.label}`;
                miniTag.className = "mini-wind-chip " + classification.className;*
                */
            }

            loadForecast();

            // ========================
            // THREE.JS – ESCENA SIMPLE
            // ========================
            (function initThree() {
                const container = document.getElementById("three-container");
                const canvas = document.getElementById("three-canvas");

                const scene = new THREE.Scene();
                scene.background = new THREE.Color(0x020617);

                const camera = new THREE.PerspectiveCamera(
                    35,
                    container.clientWidth / container.clientHeight,
                    0.1,
                    100
                );
                camera.position.set(6, 6, 6);
                camera.lookAt(0, 0, 0);

                const renderer = new THREE.WebGLRenderer({
                    canvas: canvas,
                    antialias: true
                });
                renderer.setPixelRatio(window.devicePixelRatio);

                function resizeRenderer() {
                    const w = container.clientWidth;
                    const h = container.clientHeight;
                    renderer.setSize(w, h, false);
                    camera.aspect = w / h;
                    camera.updateProjectionMatrix();
                }
                resizeRenderer();

                // Luces
                const ambient = new THREE.AmbientLight(0xffffff, 0.8);
                scene.add(ambient);

                const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
                dirLight.position.set(3, 5, 2);
                scene.add(dirLight);

                // Plano (agua)
                const planeGeo = new THREE.PlaneGeometry(8, 8, 1, 1);
                const planeMat = new THREE.MeshStandardMaterial({
                    color: 0x0f172a,
                    metalness: 0.2,
                    roughness: 0.7
                });
                const plane = new THREE.Mesh(planeGeo, planeMat);
                plane.rotation.x = -Math.PI / 2;
                scene.add(plane);

                // Rider/cometa (bloque)
                const riderGeo = new THREE.BoxGeometry(0.6, 0.3, 1.2);
                const riderMat = new THREE.MeshStandardMaterial({
                    color: 0x38bdf8,
                    emissive: 0x0ea5e9,
                    emissiveIntensity: 0.35
                });
                const rider = new THREE.Mesh(riderGeo, riderMat);
                rider.position.set(0, 0.25, 0);
                scene.add(rider);

                // Flechas de viento
                const arrowGroup = new THREE.Group();
                scene.add(arrowGroup);

                function createWindArrow(zOffset) {
                    const shaftGeo = new THREE.CylinderGeometry(0.03, 0.03, 1.3, 8);
                    const shaftMat = new THREE.MeshStandardMaterial({
                        color: 0x22c55e
                    });
                    const shaft = new THREE.Mesh(shaftGeo, shaftMat);
                    shaft.rotation.z = Math.PI / 2;

                    const headGeo = new THREE.ConeGeometry(0.12, 0.25, 12);
                    const headMat = new THREE.MeshStandardMaterial({
                        color: 0x22c55e,
                        emissive: 0x16a34a,
                        emissiveIntensity: 0.35
                    });
                    const head = new THREE.Mesh(headGeo, headMat);
                    head.position.x = 0.75;
                    head.rotation.z = Math.PI / 2;

                    const arrow = new THREE.Group();
                    arrow.add(shaft);
                    arrow.add(head);
                    arrow.position.set(0, 0.2, zOffset);
                    return arrow;
                }

                const arrow1 = createWindArrow(-1.2);
                const arrow2 = createWindArrow(0);
                const arrow3 = createWindArrow(1.2);
                arrowGroup.add(arrow1, arrow2, arrow3);

                // Viento SE por defecto
                function updateWindDirection(deg) {
                    const rad = THREE.MathUtils.degToRad(deg);
                    arrowGroup.rotation.y = -rad;
                    rider.rotation.y = -rad * 0.4;
                }

                updateWindDirection(135); // Sur-Este

                let t = 0;
                function animate() {
                    requestAnimationFrame(animate);
                    t += 0.02;
                    const sway = Math.sin(t * 2) * 0.1;
                    arrowGroup.position.y = 0.2 + sway * 0.3;
                    rider.position.z = Math.sin(t * 0.6) * 1.2;
                    renderer.render(scene, camera);
                }
                animate();

                window.addEventListener("resize", resizeRenderer);
            })();
        });

        async function loadCurrentWind() {
            try {
                const url =
                    "https://api.open-meteo.com/v1/gfs?" +
                    "latitude=-30.90&longitude=-57.93&" +
                    "current=winddirection_10m,windspeed_10m";

                const res = await fetch(url);
                if (!res.ok) throw new Error("HTTP " + res.status);

                const data = await res.json();
                const dir = data.current.winddirection_10m;
                const speedMs = data.current.windspeed_10m;
                const speedKts = Math.round(speedMs / 0.514444); // m/s → nudos

                // Set UI
                document.getElementById("windDirText").textContent = dir + "°";
                document.getElementById("windSpeedText").textContent = speedKts + " nudos";

                // Arrow → rotar según la dirección real del viento
                const arrow = document.getElementById("windArrow");
                arrow.style.transform = `rotate(${dir + 180}deg)`; // viene de → va hacia

                // Rating
                const rate = document.getElementById("windRating");

                if (speedKts < 10) {
                    rate.textContent = "No navegable";
                    rate.className = "wind-rating bad";
                }
                else if (speedKts < 14) {
                    rate.textContent = "Dudoso";
                    rate.className = "wind-rating ok";
                }
                else if (speedKts <= 30) {
                    rate.textContent = "Navegable";
                    rate.className = "wind-rating good";
                }
                else {
                    rate.textContent = "Demasiado fuerte";
                    rate.className = "wind-rating bad";
                }

            } catch (err) {
                console.error(err);
                document.getElementById("windRating").textContent = "Error al cargar datos";
            }
        }

        loadCurrentWind();

        // refrescar cada 5 minutos
        setInterval(loadCurrentWind, 5 * 60 * 1000);
    </script>
</body>

</html>